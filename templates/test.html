<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中老年人抖音购物行为调查问卷</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
        body {
            background-color: #f5f5f5;
            padding: 20px;
            line-height: 1.8;
            font-size: 18px; /* 增大字体适合中老年人 */
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 24px;
        }
        .progress-container {
            margin: 20px 0;
            text-align: center;
        }
        .progress-bar {
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background-color: #2c3e50;
            width: 0%;
            transition: width 0.3s ease;
        }
        .section-title {
            color: #2c3e50;
            margin: 0 0 20px;
            font-size: 20px;
            font-weight: bold;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        .question {
            margin: 20px 0;
            padding: 20px;
            border-radius: 6px;
            background-color: #fafafa;
            display: none; /* 默认隐藏所有问题 */
            min-height: 300px; /* 确保有足够空间显示选项 */
        }
        .question.active {
            display: block; /* 只显示当前激活的问题 */
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .question p {
            margin-bottom: 15px;
            color: #333;
            font-weight: 500;
            font-size: 20px;
        }
        .options {
            margin-left: 10px;
        }
        .option {
            margin: 12px 0;
            display: flex;
            align-items: center;
        }
        input[type="radio"], input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.4); /* 增大选择框 */
        }
        label {
            color: #555;
            cursor: pointer;
            font-size: 18px;
        }
        .scale-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .scale-table th, .scale-table td {
            border: 1px solid #ddd;
            padding: 12px 8px;
            text-align: center;
            font-size: 16px;
        }
        .scale-table th {
            background-color: #f5f5f5;
            font-weight: 600;
        }
        .scale-table tr:nth-child(even) {
            background-color: #fafafa;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 30px 0 0;
        }
        .nav-btn {
            width: 140px;
            height: 45px;
            background-color: #2c3e50;
            color: #fff;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .nav-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .nav-btn:hover:not(:disabled) {
            background-color: #34495e;
        }
        .submit-btn {
            background-color: #27ae60;
        }
        .submit-btn:hover {
            background-color: #219653;
        }
        .note {
            text-align: center;
            color: #777;
            margin-top: 20px;
            font-size: 16px;
        }
        .required-hint {
            color: #e74c3c;
            font-size: 16px;
            margin-top: 10px;
            display: none;
        }
        .required-hint.show {
            display: block;
        }
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            .question {
                padding: 15px;
                min-height: 250px;
            }
            .scale-table th, .scale-table td {
                padding: 8px 5px;
                font-size: 14px;
            }
            .nav-btn {
                width: 110px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>中老年人抖音购物行为调查问卷</h1>
        <p class="note">本次调查旨在了解中老年人使用抖音购物的相关情况，问卷采用匿名形式，隐私保护措施严格。</p>
        <p class="note">数据仅用于养老服务管理专业本科论文研究</p>
        
        <p class="note">请根据您的实际情况选择合适的答案，感谢您的支持与配合！</p>

        <div class="progress-container">
            <div class="progress-text">第 <span id="current-question">1</span> 题，共 <span id="total-questions">0</span> 题</div>
            <div class="progress-bar">
                <div class="progress" id="progress-bar"></div>
            </div>
        </div>

        <div class="section-title" id="section-title"></div>
        
        <!-- 问题容器 -->
        <div id="questions-container">
            <!-- 问题将通过JS动态管理显示状态 -->
        </div>

        <div class="required-hint">请选择至少一个选项才能继续</div>
        
        <div class="navigation">
            <button class="nav-btn" id="prev-btn" disabled>上一题</button>
            <button class="nav-btn" id="next-btn">下一题</button>
            <button class="nav-btn submit-btn" id="submit-btn" style="display: none;">提交问卷</button>
        </div>
        <p class="note">问卷提交后将无法修改，感谢您的参与！</p>
    </div>

    <script>
        // 问卷数据
        const surveyData = [
            {
                section: "一、基本信息",
                questions: [
                    {
                        id: 1,
                        text: "1. 年龄",
                        type: "radio",
                        name: "age",
                        options: [
                            "50-55岁", "56-60岁", "61-65岁", "66岁以上"
                        ]
                    },
                    {
                        id: 2,
                        text: "2. 性别",
                        type: "radio",
                        name: "gender",
                        options: ["男", "女"]
                    },
                    {
                        id: 3,
                        text: "3. 教育程度",
                        type: "radio",
                        name: "education",
                        options: [
                            "小学及以下", "初中", "高中/中专", "大专/本科", "研究生及以上"
                        ]
                    },
                    {
                        id: 4,
                        text: "4. 月均可支配收入",
                        type: "radio",
                        name: "income",
                        options: [
                            "3000元以下", "3001-5000元", "5001-8000元", "8001元以上"
                        ]
                    },
                    {
                        id: 5,
                        text: "5. 目前的婚姻状况",
                        type: "radio",
                        name: "marriage",
                        options: ["未婚", "已婚", "离异", "丧偶"]
                    },
                    {
                        id: 6,
                        text: "6. 居住情况",
                        type: "radio",
                        name: "living",
                        options: [
                            "与子女同住", "独居", "夫妻同住", "养老院/其他"
                        ]
                    },
                    {
                        id: 7,
                        text: "7. 退休前的职业",
                        type: "radio",
                        name: "job",
                        options: [
                            "机关/事业单位人员", "企业员工", "军人", 
                            "个体经营/自由职业者", "农林牧渔劳动者", "其他"
                        ]
                    }
                ]
            },
            {
                section: "二、抖音使用行为特征",
                questions: [
                    {
                        id: 8,
                        text: "1. 使用时长",
                        type: "radio",
                        name: "time",
                        options: [
                            "每天<30分钟", "30分钟-1小时", "1-2小时", "2小时以上"
                        ]
                    },
                    {
                        id: 9,
                        text: "2. 登录频率",
                        type: "radio",
                        name: "frequency",
                        options: [
                            "偶尔登录", "每周2-3次", "几乎每天", "一天多次"
                        ]
                    },
                    {
                        id: 10,
                        text: "3. 使用抖音的主要目的是？（可多选）",
                        type: "checkbox",
                        name: "purpose",
                        options: [
                            "观看短视频/直播消遣娱乐", "关注新闻资讯",
                            "学习新知识（如烹饪、健康养生等）", "社交互动（与亲友、粉丝互动）",
                            "购物", "其他"
                        ]
                    },
                    {
                        id: 11,
                        text: "4. 是否在抖音平台购买过商品？",
                        type: "radio",
                        name: "purchase",
                        options: ["是", "否"]
                    }
                ]
            },
            {
                section: "三、购物偏好维度",
                questions: [
                    {
                        id: 12,
                        text: "1. 常用购物场景：（可多选）",
                        type: "checkbox",
                        name: "scene",
                        options: [
                            "短视频推荐后购买", "直播间直接下单",
                            "搜索商品主动购买", "朋友推荐链接"
                        ]
                    },
                    {
                        id: 13,
                        text: "2. 高频购买品类：（可多选）",
                        type: "checkbox",
                        name: "category",
                        options: [
                            "健康保健品", "家居日用品", "服饰鞋包",
                            "生鲜食品", "文化娱乐产品"
                        ]
                    },
                    {
                        id: 14,
                        text: "3. 价格敏感度",
                        type: "radio",
                        name: "price",
                        options: [
                            "优先选择低价商品", "注重性价比",
                            "愿意为品质支付溢价", "看主播推荐决定"
                        ]
                    },
                    {
                        id: 15,
                        text: "4. 支付方式偏好",
                        type: "radio",
                        name: "payment",
                        options: [
                            "子女代付", "微信支付", "支付宝",
                            "抖音支付", "货到付款"
                        ]
                    }
                ]
            },
            {
                section: "四、技术接受度",
                questions: [
                    {
                        id: 16,
                        text: "1. 网购操作难度感知",
                        type: "radio",
                        name: "operation",
                        options: [
                            "完全无法独立操作", "需要他人协助",
                            "基本能独立完成", "熟练操作所有功能"
                        ]
                    },
                    {
                        id: 17,
                        text: "2. 功能使用障碍：（可多选）",
                        type: "checkbox",
                        name: "barrier",
                        options: [
                            "字体太小看不清", "支付流程复杂",
                            "退货退款操作困难", "广告弹窗太多"
                        ]
                    }
                ]
            },
            {
                section: "五、社交与情感需求",
                questions: [
                    {
                        id: 18,
                        text: "1. 直播互动动机：（可多选）",
                        type: "checkbox",
                        name: "interaction",
                        options: [
                            "喜欢主播称呼（如\"家人\"\"叔叔阿姨\"）",
                            "享受与主播实时聊天", "看其他用户评论凑热闹"
                        ]
                    },
                    {
                        id: 19,
                        text: "2. 购买决策影响",
                        type: "radio",
                        name: "decision",
                        options: [
                            "完全自主决定", "参考子女意见",
                            "跟随直播间多数人购买", "依赖主播推荐"
                        ]
                    }
                ]
            },
            {
                section: "六、内容与信任机制",
                questions: [
                    {
                        id: 20,
                        text: "1. 信任来源：（可多选）",
                        type: "checkbox",
                        name: "trust",
                        options: [
                            "主播专业讲解", "商品评价数量",
                            "平台官方认证", "熟人推荐"
                        ]
                    },
                    {
                        id: 21,
                        text: "2. 风险担忧",
                        type: "radio",
                        name: "risk",
                        options: [
                            "买到假冒伪劣商品", "个人信息泄露",
                            "支付安全问题", "售后维权困难"
                        ]
                    },
                    {
                        id: 22,
                        text: "3. 请根据您的实际感受对以下描述进行评分（1=非常不同意，5=非常同意）",
                        type: "scale",
                        items: [
                            {id: "A1", text: "A1. 清晰的商品展示和描述会影响我的购买决策"},
                            {id: "A2", text: "A2. 便捷的搜索和下单流程对我很重要"},
                            {id: "A3", text: "A3. 平台的售后保障（如退货、退款）让我购物更放心"},
                            {id: "A4", text: "A4. 我更喜欢通过短视频/直播这种直观的方式了解商品"},
                            {id: "B1", text: "B1. 家人、朋友的意见会影响我在抖音的购物决策"},
                            {id: "B2", text: "B2. 我信任的主播推荐商品，我会更愿意购买"},
                            {id: "B3", text: "B3. 购买热门/爆款商品能让我感觉不落伍"},
                            {id: "B4", text: "B4. 在抖音购物是我与朋友交流的一种方式"},
                            {id: "C1", text: "C1. 在抖音购物能让我感到愉悦和满足"},
                            {id: "C2", text: "C2. 刷抖音时，我容易因为促销而产生冲动消费"},
                            {id: "C3", text: "C3. 我会担心在抖音购买的商品质量不如预期"},
                            {id: "C4", text: "C4. 我认为在抖音购物是现代生活的一种方式"}
                        ]
                    }
                ]
            }
        ];

        // 全局变量
        let allQuestions = [];
        let currentQuestionIndex = 0;
        const questionsContainer = document.getElementById('questions-container');
        const sectionTitle = document.getElementById('section-title');
        const requiredHint = document.querySelector('.required-hint');

        // 初始化问卷
        function initSurvey() {
            // 扁平化所有问题
            surveyData.forEach(section => {
                section.questions.forEach(question => {
                    question.section = section.section;
                    allQuestions.push(question);
                });
            });

            // 渲染所有问题
            allQuestions.forEach((question, index) => {
                const questionElement = createQuestionElement(question, index);
                questionsContainer.appendChild(questionElement);
            });

            // 更新总数显示
            document.getElementById('total-questions').textContent = allQuestions.length;
            
            // 显示第一个问题
            updateQuestionDisplay();
        }

        // 创建问题元素
        function createQuestionElement(question, index) {
            const div = document.createElement('div');
            div.className = `question ${index === 0 ? 'active' : ''}`;
            div.dataset.id = question.id;
            div.dataset.index = index;

            // 问题文本
            const p = document.createElement('p');
            p.textContent = question.text;
            div.appendChild(p);

            // 根据问题类型创建选项
            if (question.type === 'radio' || question.type === 'checkbox') {
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options';
                
                question.options.forEach((option, optIndex) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option';
                    
                    const input = document.createElement('input');
                    input.type = question.type;
                    input.name = question.name;
                    input.id = `${question.name}_${optIndex}`;
                    
                    const label = document.createElement('label');
                    label.htmlFor = `${question.name}_${optIndex}`;
                    label.textContent = option;
                    
                    optionDiv.appendChild(input);
                    optionDiv.appendChild(label);
                    optionsDiv.appendChild(optionDiv);
                });
                
                div.appendChild(optionsDiv);
            } 
            // 量表题
            else if (question.type === 'scale') {
                const table = document.createElement('table');
                table.className = 'scale-table';
                
                // 表头
                let thead = document.createElement('thead');
                let headerRow = document.createElement('tr');
                headerRow.innerHTML = `
                    <th>题项</th>
                    <th>非常不同意（1分）</th>
                    <th>不同意（2分）</th>
                    <th>一般（3分）</th>
                    <th>同意（4分）</th>
                    <th>非常同意（5分）</th>
                `;
                thead.appendChild(headerRow);
                table.appendChild(thead);
                
                // 表体
                let tbody = document.createElement('tbody');
                question.items.forEach(item => {
                    let row = document.createElement('tr');
                    row.innerHTML = `<td>${item.text}</td>`;
                    
                    // 添加评分选项
                    for (let i = 1; i <= 5; i++) {
                        let td = document.createElement('td');
                        td.innerHTML = `<input type="radio" name="${item.id}" value="${i}">`;
                        row.appendChild(td);
                    }
                    
                    tbody.appendChild(row);
                });
                
                table.appendChild(tbody);
                div.appendChild(table);
            }

            return div;
        }

        // 更新问题显示
        function updateQuestionDisplay() {
            // 隐藏所有问题
            document.querySelectorAll('.question').forEach((el, index) => {
                el.classList.remove('active');
                if (index === currentQuestionIndex) {
                    el.classList.add('active');
                }
            });
            
            // 更新章节标题
            sectionTitle.textContent = allQuestions[currentQuestionIndex].section;
            
            // 更新当前问题编号
            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            
            // 更新进度条
            const progressPercentage = ((currentQuestionIndex + 1) / allQuestions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progressPercentage}%`;
            
            // 更新导航按钮状态
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            
            // 显示或隐藏下一题和提交按钮
            if (currentQuestionIndex === allQuestions.length - 1) {
                document.getElementById('next-btn').style.display = 'none';
                document.getElementById('submit-btn').style.display = 'block';
            } else {
                document.getElementById('next-btn').style.display = 'block';
                document.getElementById('submit-btn').style.display = 'none';
            }
            
            // 滚动到顶部
            window.scrollTo({top: 0, behavior: 'smooth'});
            
            // 隐藏提示
            requiredHint.classList.remove('show');
        }

        // 验证当前问题是否已回答
        function isQuestionAnswered() {
            const currentQuestion = allQuestions[currentQuestionIndex];
            const questionElement = document.querySelector(`.question[data-index="${currentQuestionIndex}"]`);
            
            if (currentQuestion.type === 'radio') {
                // 单选题：至少一个选中
                return questionElement.querySelectorAll(`input[name="${currentQuestion.name}"]:checked`).length > 0;
            } 
            else if (currentQuestion.type === 'checkbox') {
                // 多选题：至少一个选中
                return questionElement.querySelectorAll(`input[name="${currentQuestion.name}"]:checked`).length > 0;
            } 
            else if (currentQuestion.type === 'scale') {
                // 量表题：所有子问题都需回答
                const totalItems = currentQuestion.items.length;
                const answeredItems = new Set();
                
                questionElement.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
                    answeredItems.add(radio.name);
                });
                
                return answeredItems.size === totalItems;
            }
            
            return false;
        }

        // 事件监听
        document.getElementById('next-btn').addEventListener('click', () => {
            if (isQuestionAnswered()) {
                if (currentQuestionIndex < allQuestions.length - 1) {
                    currentQuestionIndex++;
                    updateQuestionDisplay();
                }
            } else {
                requiredHint.classList.add('show');
                // 轻微震动效果提示
                document.querySelector('.question.active').style.animation = 'none';
                setTimeout(() => {
                    document.querySelector('.question.active').style.animation = 'shake 0.5s ease';
                }, 10);
            }
        });

        document.getElementById('prev-btn').addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                updateQuestionDisplay();
            }
        });

        document.getElementById('submit-btn').addEventListener('click', () => {
            if (isQuestionAnswered()) {
                // 收集答案（实际应用中可发送到服务器）
                const answers = collectAnswers();
                
                // 显示提交成功信息
                alert('感谢您完成本次问卷调查！您的回答对我们非常重要。');
                
                // 控制台输出答案（实际应用中可删除）
                console.log('问卷答案:', answers);
            } else {
                requiredHint.classList.add('show');
            }
        });

        // 收集所有答案
        function collectAnswers() {
            const answers = {};
            
            // 收集单选题和多选题答案
            allQuestions.forEach(question => {
                if (question.type === 'radio' || question.type === 'checkbox') {
                    const selectedOptions = [];
                    document.querySelectorAll(`input[name="${question.name}"]:checked`).forEach(input => {
                        selectedOptions.push(input.nextElementSibling.textContent);
                    });
                    answers[question.name] = selectedOptions.join('; ');
                }
                // 收集量表题答案
                else if (question.type === 'scale') {
                    question.items.forEach(item => {
                        const selectedValue = document.querySelector(`input[name="${item.id}"]:checked`)?.value;
                        answers[item.id] = selectedValue;
                    });
                }
            });
            
            return answers;
        }

        // 添加震动动画样式
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);

        // 初始化问卷
        initSurvey();
    </script>
</body>
</html>
